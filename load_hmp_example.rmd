`r opts_chunk$set(cache=TRUE, fig.width=8)`
<link href="http://joey711.github.com/phyloseq/markdown.css" rel="stylesheet"></link>

## Load phyloseq package
```{r, message=FALSE}
library("phyloseq"); packageVersion("phyloseq")
```

## Load pre-imported HMPv35 data
The data was previously imported when [the HMP import demo](HMP_import_example.html) was interpreted and built. At the end of that demo is a `save` command that stores the `HMPv35` R data object in a compact R binary form that is easy to re-load back into R. That same data file is posted on [the phyloseq downloads page]("http://cloud.github.com/downloads/joey711/phyloseq/").
```{r}
temp_hmp_file <- tempfile()
hmp_url <- "http://cloud.github.com/downloads/joey711/phyloseq/HMPv35.RData"
download.file(hmp_url, temp_hmp_file)
load(temp_hmp_file)
```

### Clean up.
```{r}
unlink(temp_hmp_file)
rm("hmp_url", "temp_hmp_file")
```

### Investigate the phyloseq-class representation of the data
```{r}
show(HMPv35)
```

### For example, what if we wanted to root the tree?
These rank names need to be fixed. Must not have been clear during the import. This will be updated soon. The result is the default generic names added when none are provided during the import. In this case, they should be a character vector with elements like "Root", "Phylum", "Class", etc.

```{r}
rank.names(HMPv35)
```

Here is a way to check for the presence of particular taxonomic elements in the dataset.
```{r}
all(as(taxTab(HMPv35), "matrix")[1:1000, 1] == "Root")
any( "p__Crenarchaeota" %in% as(taxTab(HMPv35), "matrix")[1:1000, 2] )
any( "p__Bacteroidetes" %in% as(taxTab(HMPv35), "matrix")[1:1000, 2] )
```

Is the tree rooted?
```{r}
is.rooted(tre(HMPv35))
```

This is how you would randomly select an OTU as outgroup to root the tree:
```{r}
root(tre(HMPv35), sample(species.names(HMPv35), 1), resolve.root=TRUE)
```
